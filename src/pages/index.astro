---
import { getCollection } from 'astro:content';
import Base from '../layouts/Base.astro';
import Hero from '../components/Hero.astro';
import WorkCard from '../components/WorkCard.astro';
import MediaItem from '../components/MediaItem.astro';
import About from '../components/About.astro';
import Contact from '../components/Contact.astro';

const allWork = await getCollection('work', ({ data }) => !data.draft);
const work = allWork.sort((a, b) => a.data.order - b.data.order);
const featuredWork = work.find(w => w.data.featured);

const media = [
  {
    title: "Consequence Design and Public Systems",
    source: "Design Matters",
    type: "podcast" as const,
    link: "#",
  },
  {
    title: "Designing Government Services at Scale",
    source: "UX Conference",
    type: "talk" as const,
    link: "#",
  },
  {
    title: "Building for the Public Good",
    source: "A List Apart",
    type: "feature" as const,
    link: "#",
  },
  {
    title: "The Future of Civic Tech",
    source: "Gov Tech Magazine",
    type: "interview" as const,
    link: "#",
  },
];

const socials = [
  { name: "Bluesky", url: "https://bsky.app/profile/ronbronson.com" },
  { name: "LinkedIn", url: "https://linkedin.com/in/ronbronson" },
  { name: "GitHub", url: "https://github.com/ronbronson" },
];
---

<Base title="Ron Bronson — Designer">
  <main>
    <Hero
      name="Ron Bronson"
      tagline="I design how public systems make decisions."
      location="Portland, OR"
    />

    <!-- Featured case study -->
    {featuredWork && (
      <section class="featured">
        <div class="container">
          <p class="label">Featured</p>
          <a href={featuredWork.data.externalUrl || `/work/${featuredWork.slug}`} class="featured__link">
            <h2>{featuredWork.data.title}</h2>
            <p>{featuredWork.data.summary}</p>
            <span class="featured__cta">Read case study →</span>
          </a>
        </div>
      </section>
    )}

    <!-- Work grid -->
    <section id="work">
      <div class="container">
        <h2 class="section-heading">Selected Work</h2>
        <div class="work-grid">
          {work.map(item => (
            <WorkCard
              title={item.data.title}
              summary={item.data.summary}
              systemType={item.data.systemType}
              outcome={item.data.outcome}
              href={item.data.externalUrl || `/work/${item.slug}`}
              tags={item.data.tags}
            />
          ))}
        </div>
      </div>
    </section>

    <!-- Media -->
    <section id="media">
      <div class="container">
        <h2 class="section-heading">Media</h2>
        <p class="section-intro">Invited conversations about service design, public-sector delivery, and system consequences.</p>
        <div class="media-grid">
          {media.map(item => (
            <MediaItem
              title={item.title}
              source={item.source}
              type={item.type}
              link={item.link}
            />
          ))}
        </div>
      </div>
    </section>

    <!-- About -->
    <section id="about">
      <div class="container">
        <h2 class="section-heading">About</h2>
        <About
          content={`<p>I've spent my career at the intersection of design, policy, and technology—from federal agencies like 18F to universities to civic tech organizations. My work focuses on how public institutions make decisions and serve people at scale.</p>

          <p>I teach, write, and speak about <strong>consequence design</strong>: understanding the downstream effects of design decisions, especially in high-stakes systems where getting it wrong has real human impact.</p>

          <p>Outside of work, I'm a tea sommelier, high school tennis coach, and host a local radio show. I believe the same systems thinking that helps design better public services also helps you steep a perfect cup of tea.</p>`}
        />
      </div>
    </section>

    <!-- Contact -->
    <section id="contact">
      <div class="container">
        <Contact
          email="hello@ronbronson.dev"
          socials={socials}
        />
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="container">
      <p>&copy; {new Date().getFullYear()} Ron Bronson</p>
    </div>
  </footer>
</Base>

<style>
  /* Featured section */
  .featured {
    border-bottom: 1px solid var(--surface-3);
  }

  .featured__link {
    display: block;
    text-decoration: none;
  }

  .featured__link h2 {
    font-size: var(--font-size-3);
    color: var(--text-1);
    margin-bottom: var(--size-2);
  }

  .featured__link p {
    font-size: var(--font-size-1);
    color: var(--text-2);
    margin-bottom: var(--size-3);
  }

  .featured__cta {
    font-size: var(--font-size-0);
    color: var(--brand);
    font-weight: var(--font-weight-5);
  }

  .featured__link:hover .featured__cta {
    text-decoration: underline;
  }

  /* Section headings */
  .section-heading {
    font-size: var(--font-size-3);
    margin-bottom: var(--size-4);
  }

  .section-intro {
    color: var(--text-3);
    margin-bottom: var(--size-5);
    font-size: var(--font-size-1);
  }

  /* Work grid - 3 columns, denser */
  .work-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--size-4);
  }

  @media (max-width: 900px) {
    .work-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 600px) {
    .work-grid {
      grid-template-columns: 1fr;
    }
  }

  /* Media grid */
  .media-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--size-3);
    max-width: var(--content-width-narrow);
  }

  @media (max-width: 600px) {
    .media-grid {
      grid-template-columns: 1fr;
    }
  }

  /* Footer */
  .footer {
    padding-block: var(--size-5);
    border-top: 1px solid var(--surface-3);
    text-align: center;
    font-size: var(--font-size-0);
    color: var(--text-3);
  }
</style>
